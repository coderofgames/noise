//-----------------------------------------------------------------------------------------------
//
// Debug.cpp : Defines the OutputMessage namespace
//-----------------------------------------------------------------------------------------------

#include "stdafx.h"
#include "debug.h"

//-----------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------
namespace OutputMessage
{
	char output[1024];


	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
	void Format(char* buffer, const char* text, va_list ArgList)
	{
		vsprintf(buffer, text, ArgList);
	}

	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
	WCHAR * ToWchar (char *inpt, WCHAR *strout)
	{	
		MultiByteToWideChar (CP_ACP, 0, inpt, -1, strout, 1024);
		return strout;
	}
	// not tested
	char* Tochars (WCHAR* inpt, char* text)
	{
		for(Int32 i = 0; i < MAX_LOADSTRING; i++ )
		{
			if( inpt[i] )
				text[i] = (char)inpt[i];
			else 
			{
				text[i] = '\0';
				break;
			}
		}
		return text;
	}
	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
	void DebugPrint (char *format, ...)
	{
		char buf[1024];

		va_list args;
		va_start(args, format);
		vsprintf(buf, format, args);
		va_end(args);

		WCHAR strout[MAX_LOADSTRING];
		ToWchar(buf, strout);

		OutputDebugString(strout);
	}
	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
	void MessageBoxPrint (char *format, ...)
	{
		char buf[1024];

		va_list args;
		va_start(args, format);
		vsprintf(buf, format, args);
		va_end(args);

		WCHAR strout[1024];
		ToWchar(buf,strout);

		MessageBox(0, strout, L"MESSAGE!", 0);
	}
	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
	void Log (char *format, ...)
	{
		char buf[1024];

		va_list args;
		va_start(args, format);
		vsprintf(buf, format, args);
		va_end(args);

		FILE *fp = fopen("log.txt", "a+t");
		fprintf(fp, "%s\n", buf);
		fclose(fp);
	}
	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
	char* Format (char* format, ...)
	{
		va_list args;
		va_start(args, format);
		Format(output, format,args );
		va_end(args);

		return output;
	}
	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
	void Message(std::string str)
	{
		const char* buf = str.c_str();
		
		WCHAR strout[MAX_LOADSTRING];
		ToWchar((char*)buf, strout);
		
		MessageBox(0, strout, L"MESSAGE!", 0);
	}
	//-----------------------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------------------
};
//-----------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------